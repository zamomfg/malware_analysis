# PDF analysis

## Tools

| Tool             | Link           |
| ---------------- | -------------- |
| Peepdf           | https://github.com/jesparza/peepdf |

### Techniques

Reference to objects are written `5 0 R` where "5" in this case is refering to the object number 5.


#### Peepdf

Peepdf dont support python 3 only python 2

```bash
┌─[cluless@ParrotOS]─[~/malware_analysis/pdf]
└──╼ $python2 /opt/pdf/peepdf/peepdf.py -if sus_pdf.pdf
```

Use `-i` for a interactive analysis of the PDF

Use `-f` to force the analysis of PDF, this will allow a PDF to be analysed with PDF parsing errors. Which is nothing strange when it comes to malicious PDFs.

Use `-l` to parse the PDF file without looking for `endobj` tag. Useful for finding object files without the ending tag.

## Resources

|                  | Link           |
| ---------------- | -------------- |
| PDF Documentation | https://web.archive.org/web/20220113130243/https://www.adobe.com/content/dam/acom/en/devnet/pdf/pdfs/PDF32000_2008.pdf |
| PDF Basic structure | https://resources.infosecinstitute.com/topic/pdf-file-format-basic-structure/ |
| PDF Object streams | https://blog.didierstevens.com/2008/05/19/pdf-stream-objects/ |
| Adobe acrobad API | https://opensource.adobe.com/dc-acrobat-sdk-docs/acrobatsdk/pdfs/acrobatsdk_jsapiref.pdf |
| Basic analysis info   | https://www.intezer.com/blog/incident-response/analyze-malicious-pdf-files/ |
| Basic usage of Peepdf | https://eternal-todo.com/tools/peepdf-pdf-analysis-tool |